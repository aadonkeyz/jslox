(this.webpackJsonpjslox=this.webpackJsonpjslox||[]).push([[0],{118:function(e,t,i){},121:function(e,t,i){},197:function(e,t,i){},198:function(e,t,i){"use strict";i.r(t);var n={};i.r(n),i.d(n,"BaseExpression",(function(){return w})),i.d(n,"BinaryExpression",(function(){return N})),i.d(n,"LogicalExpression",(function(){return L})),i.d(n,"GroupingExpression",(function(){return C})),i.d(n,"LiteralExpression",(function(){return U})),i.d(n,"UnaryExpression",(function(){return F})),i.d(n,"VariableExpression",(function(){return H})),i.d(n,"AssignmentExpression",(function(){return B})),i.d(n,"CallExpression",(function(){return _})),i.d(n,"GetExpression",(function(){return G})),i.d(n,"SetExpression",(function(){return P})),i.d(n,"ThisExpression",(function(){return D})),i.d(n,"SuperExpression",(function(){return M}));var s,a,r=i(0),c=i.n(r),o=i(35),u=i.n(o),h=(i(118),i(29)),l=i(203),v=i(82),f=i(108),m=i(202),p=i(204),d=i(201),E=i(206),y=i(207),b=i(100),k=i(8),O=i(9),j=i(24);!function(e){e.AND="and",e.CLASS="class",e.ELSE="else",e.FALSE="false",e.FUN="fun",e.FOR="for",e.IF="if",e.NIL="nil",e.OR="or",e.PRINT="print",e.RETURN="return",e.SUPER="super",e.THIS="this",e.TRUE="true",e.VAR="var",e.WHILE="while",e.LEFT_PARENTHESE="(",e.RIGHT_PARENTHESE=")",e.LEFT_BRACE="{",e.RIGHT_BRACE="}",e.COMMA=",",e.DOT=".",e.MINUS="-",e.PLUS="+",e.SEMICOLON=";",e.SLASH="/",e.STAR="*",e.BANG="!",e.BANG_EQUAL="!=",e.EQUAL="=",e.EQUAL_EQUAL="==",e.GREATER=">",e.GREATER_EQUAL=">=",e.LESS="<",e.LESS_EQUAL="<=",e.IDENTIFIER="identifier",e.STRING="string",e.NUMBER="number",e.EOF="eof"}(a||(a={}));var x,S,T=(s={},Object(j.a)(s,a.AND,a.AND),Object(j.a)(s,a.CLASS,a.CLASS),Object(j.a)(s,a.ELSE,a.ELSE),Object(j.a)(s,a.FALSE,a.FALSE),Object(j.a)(s,a.FUN,a.FUN),Object(j.a)(s,a.FOR,a.FOR),Object(j.a)(s,a.IF,a.IF),Object(j.a)(s,a.NIL,a.NIL),Object(j.a)(s,a.OR,a.OR),Object(j.a)(s,a.PRINT,a.PRINT),Object(j.a)(s,a.RETURN,a.RETURN),Object(j.a)(s,a.SUPER,a.SUPER),Object(j.a)(s,a.THIS,a.THIS),Object(j.a)(s,a.TRUE,a.TRUE),Object(j.a)(s,a.VAR,a.VAR),Object(j.a)(s,a.WHILE,a.WHILE),s),A=function e(t){Object(k.a)(this,e),this.type=void 0,this.lexeme=void 0,this.line=void 0,this.column=void 0,this.literal=void 0,this.type=t.type,this.lexeme=t.lexeme,this.line=t.line,this.column=t.column,this.literal=t.literal},I=function(){function e(t){Object(k.a)(this,e),this.source=void 0,this.tokens=void 0,this.start=void 0,this.current=void 0,this.line=void 0,this.errors=void 0,this.source=t,this.tokens=[],this.start=0,this.current=0,this.line=1,this.errors=[]}return Object(O.a)(e,[{key:"scan",value:function(){for(;!this.isAtEnd();)this.start=this.current,this.scanToken();this.tokens.push(new A({type:a.EOF,lexeme:"",line:this.line,column:this.calculateColumn(this.source.length-1)}))}},{key:"scanToken",value:function(){var e=this.advance();switch(e){case"(":this.addToken(a.LEFT_PARENTHESE);break;case")":this.addToken(a.RIGHT_PARENTHESE);break;case"{":this.addToken(a.LEFT_BRACE);break;case"}":this.addToken(a.RIGHT_BRACE);break;case",":this.addToken(a.COMMA);break;case".":this.addToken(a.DOT);break;case"-":this.addToken(a.MINUS);break;case"+":this.addToken(a.PLUS);break;case";":this.addToken(a.SEMICOLON);break;case"*":this.addToken(a.STAR);break;case"!":this.addToken(this.match("=")?a.BANG_EQUAL:a.BANG);break;case"=":this.addToken(this.match("=")?a.EQUAL_EQUAL:a.EQUAL);break;case"<":this.addToken(this.match("=")?a.LESS_EQUAL:a.LESS);break;case">":this.addToken(this.match("=")?a.GREATER_EQUAL:a.GREATER);break;case"/":if(this.match("/"))for(;"\n"!==this.peek()&&!this.isAtEnd();)this.advance();else this.addToken(a.SLASH);break;case" ":case"\r":case"\t":break;case"\n":this.line++;break;case'"':case"'":this.handleString(e);break;default:this.isDigit(e)?this.handleDigit():this.isAlpha(e)?this.handleAlpha():this.errors.push({line:this.line,column:this.calculateColumn(this.current-1),message:"Unexpected character"})}}},{key:"isAtEnd",value:function(){return this.current>=this.source.length}},{key:"advance",value:function(){return this.source[this.current++]||""}},{key:"peek",value:function(){return this.source[this.current]||""}},{key:"peekNext",value:function(){return this.source[this.current+1]||""}},{key:"match",value:function(e){return!this.isAtEnd()&&(this.source[this.current]===e&&(this.current++,!0))}},{key:"isDigit",value:function(e){return/^[0-9]$/.test(e)}},{key:"isAlpha",value:function(e){return/^[_a-zA-Z]$/.test(e)}},{key:"handleString",value:function(e){for(;this.peek()!==e&&!this.isAtEnd();)"\n"===this.peek()&&this.line++,this.advance();if(this.isAtEnd())this.errors.push({line:this.line,column:this.calculateColumn(this.current-1),message:"Unterminated string"});else{this.advance();var t=this.source.slice(this.start+1,this.current-1);this.addToken(a.STRING,t)}}},{key:"handleDigit",value:function(){for(;this.isDigit(this.peek());)this.advance();if("."===this.peek()&&this.isDigit(this.peekNext()))for(this.advance();this.isDigit(this.peek());)this.advance();var e=Number(this.source.slice(this.start,this.current));this.addToken(a.NUMBER,e)}},{key:"handleAlpha",value:function(){for(;this.isAlpha(this.peek())||this.isDigit(this.peek());)this.advance();var e=this.source.slice(this.start,this.current),t=e in T?T[e]:a.IDENTIFIER;this.addToken(t)}},{key:"addToken",value:function(e,t){var i=this.source.slice(this.start,this.current);this.tokens.push(new A({type:e,lexeme:i,line:this.line,column:this.calculateColumn(this.start),literal:t}))}},{key:"calculateColumn",value:function(e){return e-this.source.slice(0,e).lastIndexOf("\n")}}]),e}(),g=i(23),R=i(22),w=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,[{key:"accept",value:function(e){}}]),e}(),N=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).left=void 0,a.operator=void 0,a.right=void 0,a.left=e,a.operator=n,a.right=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitBinaryExpression(this)}}]),i}(w),L=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).left=void 0,a.operator=void 0,a.right=void 0,a.left=e,a.operator=n,a.right=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitLogicalExpression(this)}}]),i}(w),C=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).expression=void 0,n.expression=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitGroupingExpression(this)}}]),i}(w),U=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).value=void 0,n.value=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitLiteralExpression(this)}}]),i}(w),F=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).operator=void 0,s.expression=void 0,s.operator=e,s.expression=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitUnaryExpression(this)}}]),i}(w),H=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).name=void 0,n.name=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitVariableExpression(this)}}]),i}(w),B=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).name=void 0,s.value=void 0,s.name=e,s.value=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitAssignmentExpression(this)}}]),i}(w),_=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).callee=void 0,a.args=void 0,a.endParenthese=void 0,a.callee=e,a.args=n,a.endParenthese=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitCallExpression(this)}}]),i}(w),G=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).object=void 0,s.name=void 0,s.object=e,s.name=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitGetExpression(this)}}]),i}(w),P=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).object=void 0,a.name=void 0,a.value=void 0,a.object=e,a.name=n,a.value=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitSetExpression(this)}}]),i}(w),D=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).keyword=void 0,n.keyword=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitThisExpression(this)}}]),i}(w),M=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).keyword=void 0,s.method=void 0,s.keyword=e,s.method=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){return e.visitSuperExpression(this)}}]),i}(w),z=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,[{key:"accept",value:function(e){}}]),e}(),Q=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).expression=void 0,n.expression=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitExpressionStatement(this)}}]),i}(z),V=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).condition=void 0,a.thenBranch=void 0,a.elseBranch=void 0,a.condition=e,a.thenBranch=n,a.elseBranch=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitIfStatement(this)}}]),i}(z),W=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).expression=void 0,n.expression=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitPrintStatement(this)}}]),i}(z),Z=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).condition=void 0,s.body=void 0,s.condition=e,s.body=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitWhileStatement(this)}}]),i}(z),q=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).initializer=void 0,n.condition=void 0,n.updator=void 0,n.body=void 0,n.initializer=e.initializer,n.condition=e.condition,n.updator=e.updator,n.body=e.body,n}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitForStatement(this)}}]),i}(z),J=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).name=void 0,s.initializer=void 0,s.name=e,s.initializer=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitVarStatement(this)}}]),i}(z),K=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e){var n;return Object(k.a)(this,i),(n=t.call(this)).statements=void 0,n.statements=e,n}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitBlockStatement(this)}}]),i}(z),Y=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).name=void 0,a.params=void 0,a.body=void 0,a.name=e,a.params=n,a.body=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitFunctionStatement(this)}}]),i}(z),$=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n){var s;return Object(k.a)(this,i),(s=t.call(this)).keyword=void 0,s.value=void 0,s.keyword=e,s.value=n,s}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitReturnStatement(this)}}]),i}(z),X=function(e){Object(g.a)(i,e);var t=Object(R.a)(i);function i(e,n,s){var a;return Object(k.a)(this,i),(a=t.call(this)).name=void 0,a.superclass=void 0,a.methods=void 0,a.name=e,a.superclass=n,a.methods=s,a}return Object(O.a)(i,[{key:"accept",value:function(e){e.visitClassStatement(this)}}]),i}(z),ee=function(){function e(t){Object(k.a)(this,e),this.tokens=void 0,this.current=void 0,this.statements=void 0,this.errors=void 0,this.tokens=t,this.current=0,this.statements=[],this.errors=[]}return Object(O.a)(e,[{key:"parse",value:function(){for(;!this.isAtEnd();){var e=this.declaration();e&&this.statements.push(e)}}},{key:"declaration",value:function(){try{return this.match([a.FUN])?this.funDecl("function"):this.match([a.CLASS])?this.classDecl():this.match([a.VAR])?this.varDecl():this.statement()}catch(e){this.synchronize()}}},{key:"funDecl",value:function(e){var t=this.consume(a.IDENTIFIER,"Expect ".concat(e," name"));this.consume(a.LEFT_PARENTHESE,'Expect "(" after '.concat(e," name"));var i=[];if(!this.check(a.RIGHT_PARENTHESE))do{i.push(this.consume(a.IDENTIFIER,"Expect parameter name"))}while(this.match([a.COMMA]));this.consume(a.RIGHT_PARENTHESE,'Expect ")" after parameters'),this.consume(a.LEFT_BRACE,'Expect "{" before '.concat(e," body"));var n=new K(this.block());return new Y(t,i,n)}},{key:"classDecl",value:function(){var e=this.consume(a.IDENTIFIER,"Expect class name"),t=null;this.match([a.LESS])&&(this.consume(a.IDENTIFIER,"Expect superclass name"),t=new H(this.previous())),this.consume(a.LEFT_BRACE,'Expect "{" before class body');for(var i=[];!this.check(a.RIGHT_BRACE)&&!this.isAtEnd();)i.push(this.funDecl("method"));return this.consume(a.RIGHT_BRACE,'Expect "}" after class body'),new X(e,t,i)}},{key:"varDecl",value:function(){var e,t=this.consume(a.IDENTIFIER,"Expect variable name");return this.match([a.EQUAL])&&(e=this.expression()),this.consume(a.SEMICOLON,'Expect ";" after variable declaration'),new J(t,e)}},{key:"statement",value:function(){return this.match([a.IF])?this.ifStmt():this.match([a.PRINT])?this.printStmt():this.match([a.RETURN])?this.returnStmt():this.match([a.WHILE])?this.whileStmt():this.match([a.FOR])?this.forStmt():this.match([a.LEFT_BRACE])?new K(this.block()):this.exprStmt()}},{key:"ifStmt",value:function(){this.consume(a.LEFT_PARENTHESE,'Expect "(" after "if"');var e=this.expression();this.consume(a.RIGHT_PARENTHESE,'Expect ")" after if condition');var t=this.statement(),i=this.match([a.ELSE])?this.statement():void 0;return new V(e,t,i)}},{key:"block",value:function(){for(var e=[];!this.check(a.RIGHT_BRACE)&&!this.isAtEnd();){var t=this.declaration();t&&e.push(t)}return this.consume(a.RIGHT_BRACE,'Expect "}" after block'),e}},{key:"exprStmt",value:function(){var e=this.expression();return this.consume(a.SEMICOLON,'Expect ";" after expression'),new Q(e)}},{key:"printStmt",value:function(){var e=this.expression();return this.consume(a.SEMICOLON,'Expect ";" after value'),new W(e)}},{key:"returnStmt",value:function(){var e=this.previous(),t=this.check(a.SEMICOLON)?new U(null):this.expression();return this.consume(a.SEMICOLON,'Expect ";" after return value'),new $(e,t)}},{key:"whileStmt",value:function(){this.consume(a.LEFT_PARENTHESE,'Expect "(" after "while"');var e=this.expression();this.consume(a.RIGHT_PARENTHESE,'Expect ")" after condition');var t=this.statement();return new Z(e,t)}},{key:"forStmt",value:function(){if(this.consume(a.LEFT_PARENTHESE,'Expect "(" after "for"'),this.check(a.RIGHT_PARENTHESE))throw this.errors.push({line:this.peek().line,column:this.peek().column,message:'There is nothing exist in the parenthese of "for"'}),new Error;var e,t,i;this.check(a.SEMICOLON)?this.advance():e=this.declaration(),this.match([a.SEMICOLON])||(t=this.expression(),this.consume(a.SEMICOLON,'Expect ";" after the condition of "for"')),this.match([a.RIGHT_PARENTHESE])||(i=this.expression(),this.consume(a.RIGHT_PARENTHESE,'Expect ")" after the parenthese of "for"'));var n=this.statement();return new q({initializer:e,condition:t,updator:i,body:n})}},{key:"expression",value:function(){return this.assignment()}},{key:"assignment",value:function(){var e=this.logicOr();if(this.match([a.EQUAL])){var t=this.previous(),i=this.assignment();if(e instanceof H){var n=e.name;return new B(n,i)}if(e instanceof G)return new P(e.object,e.name,i);throw this.errors.push({line:t.line,column:t.column,message:"Invalid assignment target"}),new Error}return e}},{key:"logicOr",value:function(){for(var e=this.logicAnd();this.match([a.OR]);){var t=this.previous(),i=this.logicAnd();e=new L(e,t,i)}return e}},{key:"logicAnd",value:function(){for(var e=this.equality();this.match([a.AND]);){var t=this.previous(),i=this.equality();e=new L(e,t,i)}return e}},{key:"equality",value:function(){for(var e=this.comparison();this.match([a.BANG_EQUAL,a.EQUAL_EQUAL]);){var t=this.previous(),i=this.comparison();e=new N(e,t,i)}return e}},{key:"comparison",value:function(){for(var e=this.term();this.match([a.GREATER,a.GREATER_EQUAL,a.LESS,a.LESS_EQUAL]);){var t=this.previous(),i=this.term();e=new N(e,t,i)}return e}},{key:"term",value:function(){for(var e=this.factor();this.match([a.MINUS,a.PLUS]);){var t=this.previous(),i=this.factor();e=new N(e,t,i)}return e}},{key:"factor",value:function(){for(var e=this.unary();this.match([a.SLASH,a.STAR]);){var t=this.previous(),i=this.unary();e=new N(e,t,i)}return e}},{key:"unary",value:function(){if(this.match([a.BANG,a.MINUS])){var e=this.previous(),t=this.unary();return new F(e,t)}return this.call()}},{key:"call",value:function(){for(var e=this.primary();this.match([a.LEFT_PARENTHESE,a.DOT]);){var t=this.previous().type;if(t===a.LEFT_PARENTHESE)e=this.finishCall(e);else if(t===a.DOT){var i=this.consume(a.IDENTIFIER,'Expect property name after "."');e=new G(e,i)}}return e}},{key:"finishCall",value:function(e){var t=[];if(!this.check(a.RIGHT_PARENTHESE))do{t.push(this.expression())}while(this.match([a.COMMA]));var i=this.consume(a.RIGHT_PARENTHESE,'Expect ")" after arguments');return new _(e,t,i)}},{key:"primary",value:function(){if(this.match([a.NUMBER,a.STRING]))return new U(this.previous().literal);if(this.match([a.TRUE]))return new U(!0);if(this.match([a.FALSE]))return new U(!1);if(this.match([a.NIL]))return new U(null);if(this.match([a.THIS]))return new D(this.previous());if(this.match([a.SUPER])){var e=this.previous();return this.consume(a.DOT,'Expect "." after "super"'),this.consume(a.IDENTIFIER,"Expect superclass method name"),new M(e,this.previous())}if(this.match([a.IDENTIFIER]))return new H(this.previous());if(this.match([a.LEFT_PARENTHESE])){var t=new C(this.expression());return this.consume(a.RIGHT_PARENTHESE,'Expect ")" after expression'),t}throw this.errors.push({line:this.peek().line,column:this.peek().column,message:'Unexpected token "'.concat(this.peek().lexeme,'"')}),new Error}},{key:"match",value:function(e){for(var t=0;t<e.length;t++)if(this.check(e[t]))return this.advance(),!0;return!1}},{key:"consume",value:function(e,t){if(this.check(e))return this.advance();throw this.errors.push({line:this.previous().line,column:this.previous().column,message:t}),new Error}},{key:"check",value:function(e){return!this.isAtEnd()&&e===this.peek().type}},{key:"advance",value:function(){return this.isAtEnd()||this.current++,this.previous()}},{key:"peek",value:function(){return this.tokens[this.current]}},{key:"previous",value:function(){return this.tokens[this.current-1]}},{key:"isAtEnd",value:function(){return this.peek().type===a.EOF}},{key:"synchronize",value:function(){for(;!this.isAtEnd();){if(this.previous().type===a.SEMICOLON)return;switch(this.peek().type){case a.CLASS:case a.FUN:case a.VAR:case a.FOR:case a.IF:case a.WHILE:case a.PRINT:case a.RETURN:return}this.advance()}}}]),e}();!function(e){e[e.NONE=0]="NONE",e[e.FUNCTION=1]="FUNCTION",e[e.METHOD=2]="METHOD",e[e.INITIALIZER=3]="INITIALIZER"}(x||(x={})),function(e){e[e.NONE=0]="NONE",e[e.CLASS=1]="CLASS",e[e.SUBCLASS=2]="SUBCLASS"}(S||(S={}));var te=function(){function e(t){Object(k.a)(this,e),this.statements=void 0,this.scopes=void 0,this.scopeRecord=void 0,this.functionType=void 0,this.classType=void 0,this.errors=void 0,this.statements=t,this.scopes=[],this.scopeRecord=new Map,this.functionType=x.NONE,this.classType=S.NONE,this.errors=[]}return Object(O.a)(e,[{key:"analysis",value:function(){this.evaluateList(this.statements)}},{key:"evaluateList",value:function(e){for(var t=0;t<e.length;t++)this.evaluateItem(e[t])}},{key:"evaluateItem",value:function(e){e.accept(this)}},{key:"evaluateFunction",value:function(e,t){var i=this,n=this.functionType;this.functionType=t,this.scopes.push({}),e.params.forEach((function(e){i.declare(e),i.define(e)})),this.evaluateList(e.body.statements),this.scopes.pop(),this.functionType=n}},{key:"declare",value:function(e){0!==this.scopes.length&&(this.scopes[this.scopes.length-1][e.lexeme]=!1)}},{key:"define",value:function(e){0!==this.scopes.length&&(this.scopes[this.scopes.length-1][e.lexeme]=!0)}},{key:"calculate",value:function(e,t){for(var i=this.scopes.length-1;i>=0;i--)if(t.lexeme in this.scopes[i])return void this.scopeRecord.set(e,this.scopes.length-1-i)}},{key:"visitExpressionStatement",value:function(e){this.evaluateItem(e.expression)}},{key:"visitIfStatement",value:function(e){this.evaluateItem(e.condition),this.evaluateItem(e.thenBranch),e.elseBranch&&this.evaluateItem(e.elseBranch)}},{key:"visitPrintStatement",value:function(e){this.evaluateItem(e.expression)}},{key:"visitWhileStatement",value:function(e){this.evaluateItem(e.condition),this.evaluateItem(e.body)}},{key:"visitForStatement",value:function(e){this.scopes.push({}),e.initializer&&this.evaluateItem(e.initializer),e.condition&&this.evaluateItem(e.condition),e.updator&&this.evaluateItem(e.updator),this.evaluateItem(e.body),this.scopes.pop()}},{key:"visitVarStatement",value:function(e){this.declare(e.name),e.initializer&&this.evaluateItem(e.initializer),this.define(e.name)}},{key:"visitBlockStatement",value:function(e){this.scopes.push({}),this.evaluateList(e.statements),this.scopes.pop()}},{key:"visitFunctionStatement",value:function(e){this.declare(e.name),this.define(e.name),this.evaluateFunction(e,x.FUNCTION)}},{key:"visitReturnStatement",value:function(e){this.functionType===x.NONE&&this.errors.push({line:e.keyword.line,column:e.keyword.column,message:"Can't return from top-level code"}),e.value instanceof n.LiteralExpression&&null===e.value.value||(this.functionType===x.INITIALIZER&&this.errors.push({line:e.keyword.line,column:e.keyword.column,message:"Can't use return a value from an initializer"}),this.evaluateItem(e.value))}},{key:"visitClassStatement",value:function(e){var t=this,i=this.classType;this.classType=S.CLASS,this.declare(e.name),e.superclass&&(e.name.lexeme===e.superclass.name.lexeme&&this.errors.push({line:e.name.line,column:e.name.column,message:"A class can't inherit from itself(\"".concat(e.name.lexeme,'")')}),this.evaluateItem(e.superclass),this.scopes.push({super:!0}),this.classType=S.SUBCLASS),this.scopes.push({this:!0}),e.methods.forEach((function(e){t.evaluateFunction(e,"init"===e.name.lexeme?x.INITIALIZER:x.METHOD)})),this.scopes.pop(),e.superclass&&this.scopes.pop(),this.define(e.name),this.classType=i}},{key:"visitBinaryExpression",value:function(e){this.evaluateItem(e.left),this.evaluateItem(e.right)}},{key:"visitLogicalExpression",value:function(e){this.evaluateItem(e.left),this.evaluateItem(e.right)}},{key:"visitGroupingExpression",value:function(e){this.evaluateItem(e.expression)}},{key:"visitLiteralExpression",value:function(e){}},{key:"visitUnaryExpression",value:function(e){this.evaluateItem(e.expression)}},{key:"visitVariableExpression",value:function(e){0!==this.scopes.length&&!1===this.scopes[this.scopes.length-1][e.name.lexeme]&&this.errors.push({line:e.name.line,column:e.name.column,message:"Can't read local variable in its own initializer(\"".concat(e.name.lexeme,'")')}),this.calculate(e,e.name)}},{key:"visitAssignmentExpression",value:function(e){this.evaluateItem(e.value),this.calculate(e,e.name)}},{key:"visitCallExpression",value:function(e){this.evaluateItem(e.callee),this.evaluateList(e.args)}},{key:"visitGetExpression",value:function(e){this.evaluateItem(e.object)}},{key:"visitSetExpression",value:function(e){this.evaluateItem(e.value),this.evaluateItem(e.object)}},{key:"visitThisExpression",value:function(e){this.classType===S.NONE&&this.errors.push({line:e.keyword.line,column:e.keyword.column,message:'Can\'t use "this" outside of a class'}),this.calculate(e,e.keyword)}},{key:"visitSuperExpression",value:function(e){this.classType===S.NONE?this.errors.push({line:e.keyword.line,column:e.keyword.column,message:'Can\'t use "super" outside of a class'}):this.classType===S.CLASS&&this.errors.push({line:e.keyword.line,column:e.keyword.column,message:'Can\'t use "super" in a class with no superclass'}),this.calculate(e,e.keyword)}}]),e}(),ie=te,ne=i(31);var se=function(e,t,i){return new Error("".concat(i," in line ").concat(e," column ").concat(t,"."))},ae=function(){function e(t){Object(k.a)(this,e),this.values=void 0,this.enclosing=void 0,this.values={},this.enclosing=t}return Object(O.a)(e,[{key:"define",value:function(e,t){this.values[e]=t}},{key:"get",value:function(e){if(e.lexeme in this.values)return this.values[e.lexeme];if(this.enclosing)return this.enclosing.get(e);throw se(e.line,e.column,'Undefined variable at "'.concat(e.lexeme,'"'))}},{key:"getEnvironmentByDistance",value:function(e){for(var t=this;e>0&&t.enclosing;)t=t.enclosing,e-=1;return t}},{key:"assign",value:function(e,t){if(e.lexeme in this.values)this.values[e.lexeme]=t;else{if(!this.enclosing)throw se(e.line,e.column,'Undefined variable at "'.concat(e.lexeme,'"'));this.enclosing.assign(e,t)}}}]),e}(),re=function(){function e(t){Object(k.a)(this,e),this.belongClass=void 0,this.fields=void 0,this.belongClass=t,this.fields={}}return Object(O.a)(e,[{key:"get",value:function(e){if(e.lexeme in this.fields)return this.fields[e.lexeme];var t=this.belongClass.findMethod(e.lexeme);if(t)return t.bind(this);throw se(e.line,e.column,'Undefined property "'.concat(e.lexeme,'"'))}},{key:"set",value:function(e,t){this.fields[e.lexeme]=t}}]),e}(),ce=function(){function e(t,i,n){Object(k.a)(this,e),this.name=void 0,this.superclass=void 0,this.methods=void 0,this.name=t,this.superclass=i,this.methods=n}return Object(O.a)(e,[{key:"arity",value:function(){var e=this.methods.init;return e?e.arity():0}},{key:"findMethod",value:function(e){return e in this.methods?this.methods[e]:this.superclass?this.superclass.findMethod(e):null}},{key:"call",value:function(e,t){var i=new re(this),n=this.methods.init;return n&&n.bind(i).call(e,t),i}}]),e}(),oe=function e(t){Object(k.a)(this,e),this.value=void 0,this.value=t},ue=function(){function e(t,i,n){Object(k.a)(this,e),this.declaration=void 0,this.closure=void 0,this.isInitializer=void 0,this.declaration=t,this.closure=i,this.isInitializer=!!n}return Object(O.a)(e,[{key:"arity",value:function(){return this.declaration.params.length}},{key:"call",value:function(e,t){for(var i=new ae(this.closure),n=0;n<this.declaration.params.length;n++)i.define(this.declaration.params[n].lexeme,t[n]);var s=null;try{e.visitBlockStatement(this.declaration.body,i)}catch(a){if(!(a instanceof oe))throw a;s=a.value}return this.isInitializer?this.closure.values.this:s}},{key:"bind",value:function(t){var i=new ae(this.closure);return i.define("this",t),new e(this.declaration,i,this.isInitializer)}}]),e}(),he=function(){function e(t,i){Object(k.a)(this,e),this.global=void 0,this.environment=void 0,this.statements=void 0,this.scopeRecord=void 0,this.global=new ae,this.environment=this.global,this.statements=t,this.scopeRecord=i||new Map}return Object(O.a)(e,[{key:"interpret",value:function(){for(var e=0;e<this.statements.length;e++)this.execute(this.statements[e])}},{key:"evaluate",value:function(e){return e.accept(this)}},{key:"execute",value:function(e){e.accept(this)}},{key:"visitFunctionStatement",value:function(e){var t=new ue(e,this.environment);this.environment.define(e.name.lexeme,t)}},{key:"visitClassStatement",value:function(e){var t=this;this.environment.define(e.name.lexeme,null);var i=null,n=null;if(e.superclass){if(!((i=this.evaluate(e.superclass))instanceof ce))throw se(e.superclass.name.line,e.superclass.name.column,'Superclass must be a class at "'.concat(e.superclass.name.lexeme,'"'));n=this.environment,this.environment=new ae(n),this.environment.define("super",i)}var s=e.methods.reduce((function(e,i){var n=new ue(i,t.environment,"init"===i.name.lexeme);return Object(ne.a)(Object(ne.a)({},e),{},Object(j.a)({},i.name.lexeme,n))}),{}),a=new ce(e.name.lexeme,i,s);n&&(this.environment=n),this.environment.assign(e.name,a)}},{key:"visitReturnStatement",value:function(e){throw new oe(this.evaluate(e.value))}},{key:"visitExpressionStatement",value:function(e){this.evaluate(e.expression)}},{key:"visitIfStatement",value:function(e){this.evaluate(e.condition)?this.execute(e.thenBranch):e.elseBranch&&this.execute(e.elseBranch)}},{key:"visitWhileStatement",value:function(e){for(;this.evaluate(e.condition);)this.execute(e.body)}},{key:"visitForStatement",value:function(e){var t=this.environment;for(this.environment=new ae(t),e.initializer&&this.evaluate(e.initializer);e.condition&&this.evaluate(e.condition);)this.execute(e.body),e.updator&&this.evaluate(e.updator);this.environment=t}},{key:"visitPrintStatement",value:function(e){var t=this.evaluate(e.expression);console.log(t)}},{key:"visitVarStatement",value:function(e){var t=e.initializer?this.evaluate(e.initializer):null;this.environment.define(e.name.lexeme,t)}},{key:"visitBlockStatement",value:function(e,t){var i=this.environment;this.environment=t||new ae(this.environment);try{for(var n=0;n<e.statements.length;n++)this.execute(e.statements[n])}catch(s){throw this.environment=i,s}this.environment=i}},{key:"visitLiteralExpression",value:function(e){return e.value}},{key:"visitGroupingExpression",value:function(e){return this.evaluate(e.expression)}},{key:"visitUnaryExpression",value:function(e){var t=this.evaluate(e.expression);if(e.operator.type===a.MINUS){if("number"!==typeof t)throw se(e.operator.line,e.operator.column,'Operand must be a number at "'.concat(e.operator.lexeme,'"'));return-t}if(e.operator.type===a.BANG)return!t;throw se(e.operator.line,e.operator.column,"Should not happen")}},{key:"visitBinaryExpression",value:function(e){var t=this.evaluate(e.left),i=this.evaluate(e.right);switch(e.operator.type){case a.PLUS:if("number"===typeof t&&"number"===typeof i)return t+i;if("string"===typeof t&&"string"===typeof i)return t+i;throw se(e.operator.line,e.operator.column,'Operands must be two numbers or two strings "'.concat(e.operator.lexeme,'"'));case a.MINUS:case a.SLASH:case a.STAR:case a.GREATER:case a.GREATER_EQUAL:case a.LESS:case a.LESS_EQUAL:return this.numberBinaryCalculate(e.operator,t,i);case a.BANG_EQUAL:return t!==i;case a.EQUAL_EQUAL:return t===i;default:throw se(e.operator.line,e.operator.column,"Should not happen")}}},{key:"numberBinaryCalculate",value:function(e,t,i){if("number"!==typeof t||"number"!==typeof i)throw se(e.line,e.column,'Operands must be numbers at "'.concat(e.lexeme,'"'));switch(e.type){case a.MINUS:return t-i;case a.SLASH:return t/i;case a.STAR:return t*i;case a.GREATER:return t>i;case a.GREATER_EQUAL:return t>=i;case a.LESS:return t<i;case a.LESS_EQUAL:return t<=i;default:throw se(e.line,e.column,"Should not happen")}}},{key:"visitLogicalExpression",value:function(e){var t=this.evaluate(e.left);if(e.operator.type===a.OR)return t||this.evaluate(e.right);if(e.operator.type===a.AND)return t?this.evaluate(e.right):t;throw se(e.operator.line,e.operator.column,"Should not happen")}},{key:"visitAssignmentExpression",value:function(e){var t=this.evaluate(e.value);if(!this.scopeRecord.has(e))return this.global.assign(e.name,t),t;var i=this.scopeRecord.get(e);return this.environment.getEnvironmentByDistance(i).assign(e.name,t),t}},{key:"visitVariableExpression",value:function(e){if(!this.scopeRecord.has(e))return this.global.get(e.name);var t=this.scopeRecord.get(e);return this.environment.getEnvironmentByDistance(t).get(e.name)}},{key:"visitCallExpression",value:function(e){var t=this,i=this.evaluate(e.callee),n=e.args.map((function(e){return t.evaluate(e)}));if(!(i instanceof ue||i instanceof ce))throw se(e.endParenthese.line,e.endParenthese.column,'Can only call functions and classes at "'.concat(e.endParenthese.lexeme,'"'));if(n.length!==i.arity())throw se(e.endParenthese.line,e.endParenthese.column,"Expect ".concat(i.arity()," arguments but got ").concat(n.length,' at ")"'));return i.call(this,n)}},{key:"visitGetExpression",value:function(e){var t=this.evaluate(e.object);if(t instanceof re)return t.get(e.name);throw se(e.name.line,e.name.column,'Only instances have properties at "'.concat(e.name.lexeme,'"'))}},{key:"visitSetExpression",value:function(e){var t=this.evaluate(e.object);if(t instanceof re){var i=this.evaluate(e.value);return t.set(e.name,i),i}throw se(e.name.line,e.name.column,'Only instances have properties at "'.concat(e.name.lexeme,'"'))}},{key:"visitThisExpression",value:function(e){var t=this.scopeRecord.get(e);return this.environment.getEnvironmentByDistance(t).get(e.keyword)}},{key:"visitSuperExpression",value:function(e){var t=this.scopeRecord.get(e),i=this.environment.getEnvironmentByDistance(t).get(e.keyword),n=this.environment.getEnvironmentByDistance(t-1).values.this,s=i.findMethod(e.method.lexeme);if(s)return s.bind(n);throw se(e.keyword.line,e.keyword.column,"Undefined property ".concat(e.method.lexeme))}}]),e}(),le=function(){function e(t){Object(k.a)(this,e),this.source=void 0,this.scanner=void 0,this.parser=void 0,this.scopeAnalyst=void 0,this.interpreter=void 0,this.source=t}return Object(O.a)(e,[{key:"analysis",value:function(){this.scanner=new I(this.source),this.scanner.scan(),this.parser=new ee(this.scanner.tokens),this.parser.parse(),this.scopeAnalyst=new ie(this.parser.statements),this.scopeAnalyst.analysis(),this.interpreter=new he(this.parser.statements,this.scopeAnalyst.scopeRecord)}},{key:"run",value:function(){this.interpreter.interpret()}}]),e}(),ve=(i(121),i(15)),fe="Problems",me="Console",pe=[{key:fe,label:fe},{key:me,label:me}];var de=function(e){var t=e.show,i=Object(r.useState)(pe[0].key),n=Object(h.a)(i,2),s=n[0],a=n[1],c=Object(r.useState)([]),o=Object(h.a)(c,2),u=o[0],l=o[1],k=Object(r.useState)([]),O=Object(h.a)(k,2),j=O[0],x=O[1],S=Object(r.useRef)(),T=Object(r.useCallback)(Object(b.debounce)((function(e){var t=new le(e);S.current=t,t.analysis(),window.zzz=t;var i=t.scanner.errors.concat(t.parser.errors,t.scopeAnalyst.errors).map((function(e){return"".concat(e.message," in line ").concat(e.line," column ").concat(e.column,".")}));l(i)}),500),[]);return Object(r.useEffect)((function(){var e=console.log;console.log=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];x((function(e){return[].concat(Object(v.a)(e),Object(v.a)(i.map((function(e){if(null===e)return"null";if(!(e instanceof Object))return e;try{return JSON.stringify(e)}catch(t){return Object.prototype.toString.apply(e)}}))))})),e.apply(void 0,i)}}),[]),Object(ve.jsxs)("div",{className:"playground",style:{display:t?"":"none"},children:[Object(ve.jsx)(f.a,{height:"65%",defaultLanguage:"plaintext",onChange:function(e){T(e||"")}}),Object(ve.jsx)("div",{className:"terminal",children:Object(ve.jsx)(m.a,{activeKey:s,onChange:a,tabBarExtraContent:Object(ve.jsxs)(ve.Fragment,{children:[Object(ve.jsx)(p.a,{danger:!0,icon:Object(ve.jsx)(E.a,{}),style:{marginRight:16},onClick:function(){return x([])},children:Object(ve.jsx)("span",{style:{transform:"translateY(-1px)"},children:"Clear"})}),Object(ve.jsx)(p.a,{style:{background:"#52c41a"},icon:Object(ve.jsx)(y.a,{}),disabled:!S.current||u.length>0,onClick:function(){if(S.current)try{S.current.run()}catch(e){x((function(t){return[].concat(Object(v.a)(t),[e.message])}))}},children:Object(ve.jsx)("span",{style:{transform:"translateY(-1px)"},children:"Run"})})]}),children:pe.map((function(e){var t=null;e.key===fe?t=Object(ve.jsx)(d.b,{header:null,footer:null,bordered:!0,dataSource:u,renderItem:function(e){return Object(ve.jsx)(d.b.Item,{children:e})}}):e.key===me&&(t=Object(ve.jsx)(d.b,{header:null,footer:null,bordered:!0,dataSource:j,renderItem:function(e){return Object(ve.jsx)(d.b.Item,{children:e})}}));var i=e.key;return e.key===fe&&u.length>0&&(i+="(".concat(u.length,")")),Object(ve.jsx)(m.a.TabPane,{tab:i,children:t},e.key)}))})})]})},Ee=(i(197),"Playground"),ye="Grammer";var be=function(){var e=Object(r.useState)(Ee),t=Object(h.a)(e,2),i=t[0],n=t[1];return Object(ve.jsxs)("div",{className:"App",children:[Object(ve.jsxs)(l.a,{mode:"inline",theme:"dark",selectedKeys:[i],onClick:function(e){return n(e.key)},children:[Object(ve.jsx)(l.a.Item,{children:Ee},Ee),Object(ve.jsx)(l.a.Item,{children:ye},ye)]}),Object(ve.jsx)(de,{show:i===Ee}),Object(ve.jsx)("iframe",{style:{display:i===ye?"":"none",flex:"auto",height:"100%",border:"none"},title:"grammer",src:"https://craftinginterpreters.com/the-lox-language.html"})]})};u.a.render(Object(ve.jsx)(c.a.StrictMode,{children:Object(ve.jsx)(be,{})}),document.getElementById("root"))}},[[198,1,2]]]);
//# sourceMappingURL=main.c3b91961.chunk.js.map